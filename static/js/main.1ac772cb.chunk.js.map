{"version":3,"sources":["ColorPicker.js","ColorPreview.js","FileInput.js","index.js","App.js"],"names":["getMousePosition","event","canvas","x","y","type","r","getBoundingClientRect","touches","clientX","left","clientY","top","offsetX","offsetY","rgbToHex","g","b","Error","toString","forwardRef","_ref","ref","hoverColor","setHoverColor","setSelectedColor","setXPos","setYPos","canvasElement","React","useRef","_React$useState","useState","_React$useState2","Object","slicedToArray","isColorPickerActive","setIsColorPickerActive","_React$useState3","_React$useState4","hasTouchEvents","setHasTouchEvents","useImperativeHandle","loadImage","dataUrl","image","Image","onload","current","width","naturalWidth","height","naturalHeight","getContext","drawImage","src","useEffect","addEventListener","removeEventListener","this","hoverHandler","preventDefault","stopPropagation","_getMousePosition","canvasContext","_canvasContext$getIma","getImageData","data","hex","slice","clickHandler","passive","react_default","a","createElement","Fragment","className","onClick","val","ColorPreview","backgroundColor","style","FileInput","onFileLoaded","fileInput","handleFileSelection","useCallback","files","target","reader","FileReader","evt","result","readAsDataURL","onChange","console","log","rootElement","document","getElementById","ReactDOM","render","colorPickerRef","selectedColor","_React$useState5","undefined","_React$useState6","xPos","_React$useState7","_React$useState8","yPos","src_ColorPicker"],"mappings":"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","file":"static/js/main.1ac772cb.chunk.js","sourcesContent":["import React, { forwardRef } from 'react';\n\nimport './styles.css';\n\nconst getMousePosition = (event, canvas) => {\n  let x, y;\n\n  if ('touchmove' == event.type) {\n    let r = canvas.getBoundingClientRect();\n    x = event.touches[0].clientX - r.left;\n    y = event.touches[0].clientY - r.top;\n  } else {\n    x = event.offsetX;\n    y = event.offsetY;\n  }\n\n  return { x, y };\n};\n\n// This function is copied from somewhere. Forgot the source.\nconst rgbToHex = (r, g, b) => {\n  if (r > 255 || g > 255 || b > 255) throw new Error('Invalid color');\n  return ((r << 16) | (g << 8) | b).toString(16);\n};\n\nfunction ColorPicker(\n  { hoverColor, setHoverColor, setSelectedColor, setXPos, setYPos },\n  ref\n) {\n  const canvasElement = React.useRef(null);\n  const [isColorPickerActive, setIsColorPickerActive] = React.useState(false);\n  // This actually tracks whether the user starts _using_ track events.\n  const [hasTouchEvents, setHasTouchEvents] = React.useState(false);\n\n  // Define an imperative API, in order to better encapsulate canvas logic.\n  React.useImperativeHandle(ref, () => ({\n    loadImage: dataUrl => {\n      const image = new Image();\n      image.onload = () => {\n        canvasElement.current.width = image.naturalWidth;\n        canvasElement.current.height = image.naturalHeight;\n        const canvasContext = canvasElement.current.getContext('2d');\n        // Paint the image onto the canvas.\n        canvasContext.drawImage(image, 0, 0);\n      };\n\n      image.src = dataUrl;\n    },\n  }));\n\n  // Detect touch events.\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    current.addEventListener('touchstart', function() {\n      setHasTouchEvents(true);\n      current.removeEventListener('touchstart', this);\n    });\n  });\n\n  const hoverHandler = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // NOTE: Think about it, do I actually need this check?\n    if (isColorPickerActive) {\n      const { x, y } = getMousePosition(event, canvasElement.current);\n      setXPos(x);\n      setYPos(y);\n\n      const canvasContext = canvasElement.current.getContext('2d');\n      // NOTE: This currently treats transparent pixels as black.\n      const [r, g, b] = canvasContext.getImageData(x, y, 1, 1).data;\n      const hex = '#' + ('000000' + rgbToHex(r, g, b)).slice(-6);\n      setHoverColor(hex);\n    }\n  };\n\n  const clickHandler = () => {\n    setHoverColor('#FFF');\n    setSelectedColor(hoverColor);\n    setIsColorPickerActive(false);\n  };\n\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    if (isColorPickerActive) {\n      if (!hasTouchEvents) {\n        current.addEventListener('mousemove', hoverHandler, { passive: false });\n        current.addEventListener('click', clickHandler);\n      } else {\n        current.addEventListener('touchmove', hoverHandler, { passive: false });\n        current.addEventListener('touchend', clickHandler);\n      }\n    }\n\n    // Cleanup by removing the attached listeners.\n    return () => {\n      current.removeEventListener('mousemove', hoverHandler);\n      current.removeEventListener('click', clickHandler);\n      current.removeEventListener('touchmove', hoverHandler);\n      current.removeEventListener('touchend', clickHandler);\n    };\n    // There's a bug here because of not listening to exhaustive-deps. :^)\n  }, [isColorPickerActive, hasTouchEvents, hoverColor]);\n\n  return (\n    <>\n      <canvas\n        ref={canvasElement}\n        width=\"490\"\n        height=\"490\"\n        className=\"ColorPicker__canvas\"\n      />\n      <button onClick={() => setIsColorPickerActive(val => !val)}>\n        {isColorPickerActive ? 'Stop' : 'Start'} color picker\n      </button>\n    </>\n  );\n}\n\nexport default forwardRef(ColorPicker);\n","import React from 'react';\nimport './styles.css';\n\nexport default function ColorPreview({ backgroundColor }) {\n  return (\n    <div\n      className=\"ColorPreview\"\n      style={{\n        backgroundColor,\n      }}\n    />\n  );\n}\n","import React from 'react';\n\nexport default function FileInput({ onFileLoaded }) {\n  const fileInput = React.useRef(null);\n\n  const handleFileSelection = React.useCallback(\n    event => {\n      const files = event.target.files;\n      // NOTE: Unsure whether I need to check that `files` is truthy.\n      if (files && files[0]) {\n        const reader = new FileReader();\n        reader.onload = evt => {\n          onFileLoaded(evt.target.result);\n        };\n\n        reader.readAsDataURL(files[0]);\n      }\n    },\n    [onFileLoaded]\n  );\n\n  // NOTE: onChange here is acceptable, but won't be called if the same file is selected */\n  return <input ref={fileInput} type=\"file\" onChange={handleFileSelection} />;\n}\n","import 'babel-polyfill';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nconsole.log('version 8');\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n","import React from 'react';\n\nimport ColorPicker from './ColorPicker';\nimport ColorPreview from './ColorPreview';\nimport FileInput from './FileInput';\nimport './styles.css';\n\nexport default function App() {\n  const colorPickerRef = React.useRef(null);\n  const [hoverColor, setHoverColor] = React.useState('#FFF');\n  const [selectedColor, setSelectedColor] = React.useState('#FFF');\n  const [xPos, setXPos] = React.useState(undefined);\n  const [yPos, setYPos] = React.useState(undefined);\n\n  const onFileLoaded = dataUrl => {\n    if (colorPickerRef && colorPickerRef.current) {\n      colorPickerRef.current.loadImage(dataUrl);\n    }\n  };\n\n  return (\n    <div>\n      Version 2\n      <ColorPicker\n        ref={colorPickerRef}\n        hoverColor={hoverColor}\n        setHoverColor={setHoverColor}\n        setSelectedColor={setSelectedColor}\n        setXPos={setXPos}\n        setYPos={setYPos}\n      />\n      <FileInput onFileLoaded={onFileLoaded} />\n      <div className=\"App__container\">\n        <div className=\"App__column\">\n          <p>Hover Color:</p>\n          <ColorPreview backgroundColor={hoverColor} />\n\n          <p>Selected Color:</p>\n          <ColorPreview backgroundColor={selectedColor} />\n        </div>\n        <div className=\"App__column\">\n          <p>X pixel position:</p> {xPos}\n          <p>Y pixel position:</p> {yPos}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}