{"version":3,"sources":["ColorPicker.js","ColorPreview.js","FileInput.js","index.js","App.js"],"names":["getMousePosition","event","canvas","x","y","type","r","getBoundingClientRect","touches","clientX","left","clientY","top","offsetX","offsetY","rgbToHex","g","b","Error","toString","forwardRef","_ref","ref","hoverColor","setHoverColor","setSelectedColor","setXPos","setYPos","canvasElement","React","useRef","_React$useState","useState","_React$useState2","Object","slicedToArray","isColorPickerActive","setIsColorPickerActive","_React$useState3","_React$useState4","hasTouchEvents","setHasTouchEvents","useImperativeHandle","loadImage","dataUrl","image","Image","onload","current","width","naturalWidth","height","naturalHeight","getContext","drawImage","src","useEffect","addEventListener","preventDefault","passive","stopPropagation","hoverHandler","_getMousePosition","canvasContext","_canvasContext$getIma","getImageData","data","hex","slice","clickHandler","removeEventListener","react_default","a","createElement","Fragment","className","onClick","val","ColorPreview","backgroundColor","style","FileInput","onFileLoaded","fileInput","handleFileSelection","useCallback","files","target","reader","FileReader","evt","result","readAsDataURL","onChange","console","log","rootElement","document","getElementById","ReactDOM","render","colorPickerRef","selectedColor","_React$useState5","undefined","_React$useState6","xPos","_React$useState7","_React$useState8","yPos","src_ColorPicker"],"mappings":"4LAIMA,SAAmB,SAACC,EAAOC,GAC/B,IAAIC,EAAGC,EAEP,GAAI,aAAeH,EAAMI,KAAM,CAC7B,IAAIC,EAAIJ,EAAOK,wBACfJ,EAAIF,EAAMO,QAAQ,GAAGC,QAAUH,EAAEI,KACjCN,EAAIH,EAAMO,QAAQ,GAAGG,QAAUL,EAAEM,SAEjCT,EAAIF,EAAMY,QACVT,EAAIH,EAAMa,QAGZ,MAAO,CAAEX,IAAGC,OAIRW,EAAW,SAACT,EAAGU,EAAGC,GACtB,GAAIX,EAAI,KAAOU,EAAI,KAAOC,EAAI,IAAK,MAAM,IAAIC,MAAM,iBACnD,OAASZ,GAAK,GAAOU,GAAK,EAAKC,GAAGE,SAAS,KA+G9BC,2BA5Gf,SAAAC,EAEEC,GACA,IAFEC,EAEFF,EAFEE,WAAYC,EAEdH,EAFcG,cAAeC,EAE7BJ,EAF6BI,iBAAkBC,EAE/CL,EAF+CK,QAASC,EAExDN,EAFwDM,QAGlDC,EAAgBC,IAAMC,OAAO,MADnCC,EAEsDF,IAAMG,UAAS,GAFrEC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GAEOK,EAFPH,EAAA,GAE4BI,EAF5BJ,EAAA,GAAAK,EAI4CT,IAAMG,UAAS,GAJ3DO,EAAAL,OAAAC,EAAA,EAAAD,CAAAI,EAAA,GAIOE,EAJPD,EAAA,GAIuBE,EAJvBF,EAAA,GAOAV,IAAMa,oBAAoBpB,EAAK,iBAAO,CACpCqB,UAAW,SAAAC,GACT,IAAMC,EAAQ,IAAIC,MAClBD,EAAME,OAAS,WACbnB,EAAcoB,QAAQC,MAAQJ,EAAMK,aACpCtB,EAAcoB,QAAQG,OAASN,EAAMO,cACfxB,EAAcoB,QAAQK,WAAW,MAEzCC,UAAUT,EAAO,EAAG,IAGpCA,EAAMU,IAAMX,MAKhBf,IAAM2B,UAAU,WACM5B,EAAZoB,QACAS,iBACN,aACA,SAASxD,GACPA,EAAMyD,iBACNjB,GAAkB,IAEpB,CAAEkB,SAAS,MAIf,IAAMD,EAAiB,SAAAzD,GACrBA,EAAMyD,iBACNzD,EAAM2D,mBAGFC,EAAe,SAAA5D,GAKnB,GAJAA,EAAMyD,iBACNzD,EAAM2D,kBAGFxB,EAAqB,KAAA0B,EACN9D,EAAiBC,EAAO2B,EAAcoB,SAA/C7C,EADe2D,EACf3D,EAAGC,EADY0D,EACZ1D,EACXsB,EAAQvB,GACRwB,EAAQvB,GAER,IAAM2D,EAAgBnC,EAAcoB,QAAQK,WAAW,MALhCW,EAAA9B,OAAAC,EAAA,EAAAD,CAOL6B,EAAcE,aAAa9D,EAAGC,EAAG,EAAG,GAAG8D,KAPlC,GAOhB5D,EAPgB0D,EAAA,GAObhD,EAPagD,EAAA,GAOV/C,EAPU+C,EAAA,GAQjBG,EAAM,KAAO,SAAWpD,EAAST,EAAGU,EAAGC,IAAImD,OAAO,GACxD5C,EAAc2C,KAIZE,EAAe,WACnB7C,EAAc,QACdC,EAAiBF,GACjBc,GAAuB,IA6BzB,OA1BAR,IAAM2B,UAAU,WAAM,IACZR,EAAYpB,EAAZoB,QAeR,OAdIZ,IACGI,GAIHQ,EAAQS,iBAAiB,YAAaI,EAAc,CAAEF,SAAS,IAC/DX,EAAQS,iBAAiB,WAAYY,GACrCrB,EAAQS,iBAAiB,mBAAoBC,EAAgB,CAC3DC,SAAS,MANXX,EAAQS,iBAAiB,YAAaI,EAAc,CAAEF,SAAS,IAC/DX,EAAQS,iBAAiB,QAASY,KAW/B,WACLrB,EAAQsB,oBAAoB,YAAaT,GACzCb,EAAQsB,oBAAoB,QAASD,GACrCrB,EAAQsB,oBAAoB,YAAaT,GACzCb,EAAQsB,oBAAoB,WAAYD,GACxCrB,EAAQsB,oBAAoB,mBAAoBZ,KAGjD,CAACtB,EAAqBI,EAAgBjB,IAGvCgD,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACEH,EAAAC,EAAAC,cAAA,UACEnD,IAAKM,EACLqB,MAAM,MACNE,OAAO,MACPwB,UAAU,wBAEZJ,EAAAC,EAAAC,cAAA,UAAQG,QAAS,kBAAMvC,EAAuB,SAAAwC,GAAG,OAAKA,MACnDzC,EAAsB,OAAS,QADlC,oBC3HS,SAAS0C,EAATzD,GAA2C,IAAnB0D,EAAmB1D,EAAnB0D,gBACrC,OACER,EAAAC,EAAAC,cAAA,OACEE,UAAU,eACVK,MAAO,CACLD,qBCNO,SAASE,EAAT5D,GAAqC,IAAhB6D,EAAgB7D,EAAhB6D,aAC5BC,EAAYtD,IAAMC,OAAO,MAEzBsD,EAAsBvD,IAAMwD,YAChC,SAAApF,GACE,IAAMqF,EAAQrF,EAAMsF,OAAOD,MAE3B,GAAIA,GAASA,EAAM,GAAI,CACrB,IAAME,EAAS,IAAIC,WACnBD,EAAOzC,OAAS,SAAA2C,GACdR,EAAaQ,EAAIH,OAAOI,SAG1BH,EAAOI,cAAcN,EAAM,MAG/B,CAACJ,IAIH,OAAOX,EAAAC,EAAAC,cAAA,SAAOnD,IAAK6D,EAAW9E,KAAK,OAAOwF,SAAUT,IChBtDU,QAAQC,IAAI,aAEZ,IAAMC,EAAcC,SAASC,eAAe,QAC5CC,IAASC,OAAO7B,EAAAC,EAAAC,cCFD,WACb,IAAM4B,EAAiBxE,IAAMC,OAAO,MADRC,EAEQF,IAAMG,SAAS,QAFvBC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GAErBR,EAFqBU,EAAA,GAETT,EAFSS,EAAA,GAAAK,EAGcT,IAAMG,SAAS,QAH7BO,EAAAL,OAAAC,EAAA,EAAAD,CAAAI,EAAA,GAGrBgE,EAHqB/D,EAAA,GAGNd,EAHMc,EAAA,GAAAgE,EAIJ1E,IAAMG,cAASwE,GAJXC,EAAAvE,OAAAC,EAAA,EAAAD,CAAAqE,EAAA,GAIrBG,EAJqBD,EAAA,GAIf/E,EAJe+E,EAAA,GAAAE,EAKJ9E,IAAMG,cAASwE,GALXI,EAAA1E,OAAAC,EAAA,EAAAD,CAAAyE,EAAA,GAKrBE,EALqBD,EAAA,GAKfjF,EALeiF,EAAA,GAa5B,OACErC,EAAAC,EAAAC,cAAA,uBAEEF,EAAAC,EAAAC,cAACqC,EAAD,CACExF,IAAK+E,EACL9E,WAAYA,EACZC,cAAeA,EACfC,iBAAkBA,EAClBC,QAASA,EACTC,QAASA,IAEX4C,EAAAC,EAAAC,cAACQ,EAAD,CAAWC,aAjBM,SAAAtC,GACfyD,GAAkBA,EAAerD,SACnCqD,EAAerD,QAAQL,UAAUC,MAgBjC2B,EAAAC,EAAAC,cAAA,OAAKE,UAAU,kBACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAACK,EAAD,CAAcC,gBAAiBxD,IAE/BgD,EAAAC,EAAAC,cAAA,4BACAF,EAAAC,EAAAC,cAACK,EAAD,CAAcC,gBAAiBuB,KAEjC/B,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,8BADF,IAC4BiC,EAC1BnC,EAAAC,EAAAC,cAAA,8BAFF,IAE4BoC,MDjCpB,MAASb","file":"static/js/main.1ce3520c.chunk.js","sourcesContent":["import React, { forwardRef } from 'react';\n\nimport './styles.css';\n\nconst getMousePosition = (event, canvas) => {\n  let x, y;\n\n  if ('touchmove' == event.type) {\n    let r = canvas.getBoundingClientRect();\n    x = event.touches[0].clientX - r.left;\n    y = event.touches[0].clientY - r.top;\n  } else {\n    x = event.offsetX;\n    y = event.offsetY;\n  }\n\n  return { x, y };\n};\n\n// This function is copied from somewhere. Forgot the source.\nconst rgbToHex = (r, g, b) => {\n  if (r > 255 || g > 255 || b > 255) throw new Error('Invalid color');\n  return ((r << 16) | (g << 8) | b).toString(16);\n};\n\nfunction ColorPicker(\n  { hoverColor, setHoverColor, setSelectedColor, setXPos, setYPos },\n  ref\n) {\n  const canvasElement = React.useRef(null);\n  const [isColorPickerActive, setIsColorPickerActive] = React.useState(false);\n  // This actually tracks whether the user starts _using_ track events.\n  const [hasTouchEvents, setHasTouchEvents] = React.useState(false);\n\n  // Define an imperative API, in order to better encapsulate canvas logic.\n  React.useImperativeHandle(ref, () => ({\n    loadImage: dataUrl => {\n      const image = new Image();\n      image.onload = () => {\n        canvasElement.current.width = image.naturalWidth;\n        canvasElement.current.height = image.naturalHeight;\n        const canvasContext = canvasElement.current.getContext('2d');\n        // Paint the image onto the canvas.\n        canvasContext.drawImage(image, 0, 0);\n      };\n\n      image.src = dataUrl;\n    },\n  }));\n\n  // Detect touch events.\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    current.addEventListener(\n      'touchstart',\n      function(event) {\n        event.preventDefault();\n        setHasTouchEvents(true);\n      },\n      { passive: false }\n    );\n  });\n\n  const preventDefault = event => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  const hoverHandler = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // NOTE: Think about it, do I actually need this check?\n    if (isColorPickerActive) {\n      const { x, y } = getMousePosition(event, canvasElement.current);\n      setXPos(x);\n      setYPos(y);\n\n      const canvasContext = canvasElement.current.getContext('2d');\n      // NOTE: This currently treats transparent pixels as black.\n      const [r, g, b] = canvasContext.getImageData(x, y, 1, 1).data;\n      const hex = '#' + ('000000' + rgbToHex(r, g, b)).slice(-6);\n      setHoverColor(hex);\n    }\n  };\n\n  const clickHandler = () => {\n    setHoverColor('#FFF');\n    setSelectedColor(hoverColor);\n    setIsColorPickerActive(false);\n  };\n\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    if (isColorPickerActive) {\n      if (!hasTouchEvents) {\n        current.addEventListener('mousemove', hoverHandler, { passive: false });\n        current.addEventListener('click', clickHandler);\n      } else {\n        current.addEventListener('touchmove', hoverHandler, { passive: false });\n        current.addEventListener('touchend', clickHandler);\n        current.addEventListener('touchforcechange', preventDefault, {\n          passive: false,\n        });\n      }\n    }\n\n    // Cleanup by removing the attached listeners.\n    return () => {\n      current.removeEventListener('mousemove', hoverHandler);\n      current.removeEventListener('click', clickHandler);\n      current.removeEventListener('touchmove', hoverHandler);\n      current.removeEventListener('touchend', clickHandler);\n      current.removeEventListener('touchforcechange', preventDefault);\n    };\n    // There's a bug here because of not listening to exhaustive-deps. :^)\n  }, [isColorPickerActive, hasTouchEvents, hoverColor]);\n\n  return (\n    <>\n      <canvas\n        ref={canvasElement}\n        width=\"490\"\n        height=\"490\"\n        className=\"ColorPicker__canvas\"\n      />\n      <button onClick={() => setIsColorPickerActive(val => !val)}>\n        {isColorPickerActive ? 'Stop' : 'Start'} color picker\n      </button>\n    </>\n  );\n}\n\nexport default forwardRef(ColorPicker);\n","import React from 'react';\nimport './styles.css';\n\nexport default function ColorPreview({ backgroundColor }) {\n  return (\n    <div\n      className=\"ColorPreview\"\n      style={{\n        backgroundColor,\n      }}\n    />\n  );\n}\n","import React from 'react';\n\nexport default function FileInput({ onFileLoaded }) {\n  const fileInput = React.useRef(null);\n\n  const handleFileSelection = React.useCallback(\n    event => {\n      const files = event.target.files;\n      // NOTE: Unsure whether I need to check that `files` is truthy.\n      if (files && files[0]) {\n        const reader = new FileReader();\n        reader.onload = evt => {\n          onFileLoaded(evt.target.result);\n        };\n\n        reader.readAsDataURL(files[0]);\n      }\n    },\n    [onFileLoaded]\n  );\n\n  // NOTE: onChange here is acceptable, but won't be called if the same file is selected */\n  return <input ref={fileInput} type=\"file\" onChange={handleFileSelection} />;\n}\n","import 'babel-polyfill';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nconsole.log('version 8');\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n","import React from 'react';\n\nimport ColorPicker from './ColorPicker';\nimport ColorPreview from './ColorPreview';\nimport FileInput from './FileInput';\nimport './styles.css';\n\nexport default function App() {\n  const colorPickerRef = React.useRef(null);\n  const [hoverColor, setHoverColor] = React.useState('#FFF');\n  const [selectedColor, setSelectedColor] = React.useState('#FFF');\n  const [xPos, setXPos] = React.useState(undefined);\n  const [yPos, setYPos] = React.useState(undefined);\n\n  const onFileLoaded = dataUrl => {\n    if (colorPickerRef && colorPickerRef.current) {\n      colorPickerRef.current.loadImage(dataUrl);\n    }\n  };\n\n  return (\n    <div>\n      Version 5\n      <ColorPicker\n        ref={colorPickerRef}\n        hoverColor={hoverColor}\n        setHoverColor={setHoverColor}\n        setSelectedColor={setSelectedColor}\n        setXPos={setXPos}\n        setYPos={setYPos}\n      />\n      <FileInput onFileLoaded={onFileLoaded} />\n      <div className=\"App__container\">\n        <div className=\"App__column\">\n          <p>Hover Color:</p>\n          <ColorPreview backgroundColor={hoverColor} />\n\n          <p>Selected Color:</p>\n          <ColorPreview backgroundColor={selectedColor} />\n        </div>\n        <div className=\"App__column\">\n          <p>X pixel position:</p> {xPos}\n          <p>Y pixel position:</p> {yPos}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}