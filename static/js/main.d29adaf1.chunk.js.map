{"version":3,"sources":["ColorPicker.js","ColorPreview.js","FileInput.js","index.js","App.js"],"names":["getMousePosition","event","canvas","x","y","type","r","getBoundingClientRect","touches","clientX","left","clientY","top","offsetX","offsetY","rgbToHex","g","b","Error","toString","forwardRef","_ref","ref","hoverColor","setHoverColor","setSelectedColor","setXPos","setYPos","canvasElement","React","useRef","_React$useState","useState","_React$useState2","Object","slicedToArray","isColorPickerActive","setIsColorPickerActive","_React$useState3","_React$useState4","hasTouchEvents","setHasTouchEvents","useImperativeHandle","loadImage","dataUrl","image","Image","onload","current","width","naturalWidth","height","naturalHeight","getContext","drawImage","src","useEffect","addEventListener","removeEventListener","this","hoverHandler","_getMousePosition","canvasContext","_canvasContext$getIma","getImageData","data","hex","slice","clickHandler","react_default","a","createElement","Fragment","className","onClick","val","ColorPreview","backgroundColor","style","FileInput","onFileLoaded","fileInput","handleFileSelection","useCallback","files","target","reader","FileReader","evt","result","readAsDataURL","onChange","console","log","rootElement","document","getElementById","ReactDOM","render","colorPickerRef","selectedColor","_React$useState5","undefined","_React$useState6","xPos","_React$useState7","_React$useState8","yPos","src_ColorPicker"],"mappings":"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","file":"static/js/main.d29adaf1.chunk.js","sourcesContent":["import React, { forwardRef } from 'react';\n\nimport './styles.css';\n\nconst getMousePosition = (event, canvas) => {\n  let x, y;\n\n  if ('touchmove' == event.type) {\n    let r = canvas.getBoundingClientRect();\n    x = event.touches[0].clientX - r.left;\n    y = event.touches[0].clientY - r.top;\n  } else {\n    x = event.offsetX;\n    y = event.offsetY;\n  }\n\n  return { x, y };\n};\n\n// This function is copied from somewhere. Forgot the source.\nconst rgbToHex = (r, g, b) => {\n  if (r > 255 || g > 255 || b > 255) throw new Error('Invalid color');\n  return ((r << 16) | (g << 8) | b).toString(16);\n};\n\nfunction ColorPicker(\n  { hoverColor, setHoverColor, setSelectedColor, setXPos, setYPos },\n  ref\n) {\n  const canvasElement = React.useRef(null);\n  const [isColorPickerActive, setIsColorPickerActive] = React.useState(false);\n  // This actually tracks whether the user starts _using_ track events.\n  const [hasTouchEvents, setHasTouchEvents] = React.useState(false);\n\n  // Define an imperative API, in order to better encapsulate canvas logic.\n  React.useImperativeHandle(ref, () => ({\n    loadImage: dataUrl => {\n      const image = new Image();\n      image.onload = () => {\n        canvasElement.current.width = image.naturalWidth;\n        canvasElement.current.height = image.naturalHeight;\n        const canvasContext = canvasElement.current.getContext('2d');\n        // Paint the image onto the canvas.\n        canvasContext.drawImage(image, 0, 0);\n      };\n\n      image.src = dataUrl;\n    },\n  }));\n\n  // Detect touch events.\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    current.addEventListener('touchstart', function() {\n      setHasTouchEvents(true);\n      current.removeEventListener('touchstart', this);\n    });\n  });\n\n  const hoverHandler = event => {\n    // NOTE: Think about it, do I actually need this check?\n    if (isColorPickerActive) {\n      const { x, y } = getMousePosition(event, canvasElement.current);\n      setXPos(x);\n      setYPos(y);\n\n      const canvasContext = canvasElement.current.getContext('2d');\n      // NOTE: This currently treats transparent pixels as black.\n      const [r, g, b] = canvasContext.getImageData(x, y, 1, 1).data;\n      const hex = '#' + ('000000' + rgbToHex(r, g, b)).slice(-6);\n      setHoverColor(hex);\n    }\n  };\n\n  const clickHandler = () => {\n    setHoverColor('#FFF');\n    setSelectedColor(hoverColor);\n    setIsColorPickerActive(false);\n  };\n\n  React.useEffect(() => {\n    const { current } = canvasElement;\n    if (isColorPickerActive) {\n      if (!hasTouchEvents) {\n        current.addEventListener('mousemove', hoverHandler);\n        current.addEventListener('click', clickHandler);\n      } else {\n        current.addEventListener('touchmove', hoverHandler);\n        current.addEventListener('touchend', clickHandler);\n      }\n    }\n\n    // Cleanup by removing the attached listeners.\n    return () => {\n      current.removeEventListener('mousemove', hoverHandler);\n      current.removeEventListener('click', clickHandler);\n      current.removeEventListener('touchmove', hoverHandler);\n      current.removeEventListener('touchend', clickHandler);\n    };\n    // There's a bug here because of not listening to exhaustive-deps. :^)\n  }, [isColorPickerActive, hasTouchEvents, hoverColor]);\n\n  return (\n    <>\n      <canvas\n        ref={canvasElement}\n        width=\"490\"\n        height=\"490\"\n        className=\"ColorPicker__canvas\"\n      />\n      <button onClick={() => setIsColorPickerActive(val => !val)}>\n        {isColorPickerActive ? 'Stop' : 'Start'} color picker\n      </button>\n    </>\n  );\n}\n\nexport default forwardRef(ColorPicker);\n","import React from 'react';\nimport './styles.css';\n\nexport default function ColorPreview({ backgroundColor }) {\n  return (\n    <div\n      className=\"ColorPreview\"\n      style={{\n        backgroundColor,\n      }}\n    />\n  );\n}\n","import React from 'react';\n\nexport default function FileInput({ onFileLoaded }) {\n  const fileInput = React.useRef(null);\n\n  const handleFileSelection = React.useCallback(\n    event => {\n      const files = event.target.files;\n      // NOTE: Unsure whether I need to check that `files` is truthy.\n      if (files && files[0]) {\n        const reader = new FileReader();\n        reader.onload = evt => {\n          onFileLoaded(evt.target.result);\n        };\n\n        reader.readAsDataURL(files[0]);\n      }\n    },\n    [onFileLoaded]\n  );\n\n  // NOTE: onChange here is acceptable, but won't be called if the same file is selected */\n  return <input ref={fileInput} type=\"file\" onChange={handleFileSelection} />;\n}\n","import 'babel-polyfill';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nconsole.log('version 8');\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n","import React from 'react';\n\nimport ColorPicker from './ColorPicker';\nimport ColorPreview from './ColorPreview';\nimport FileInput from './FileInput';\nimport './styles.css';\n\nexport default function App() {\n  const colorPickerRef = React.useRef(null);\n  const [hoverColor, setHoverColor] = React.useState('#FFF');\n  const [selectedColor, setSelectedColor] = React.useState('#FFF');\n  const [xPos, setXPos] = React.useState(undefined);\n  const [yPos, setYPos] = React.useState(undefined);\n\n  const onFileLoaded = dataUrl => {\n    if (colorPickerRef && colorPickerRef.current) {\n      colorPickerRef.current.loadImage(dataUrl);\n    }\n  };\n\n  return (\n    <div>\n      <ColorPicker\n        ref={colorPickerRef}\n        hoverColor={hoverColor}\n        setHoverColor={setHoverColor}\n        setSelectedColor={setSelectedColor}\n        setXPos={setXPos}\n        setYPos={setYPos}\n      />\n      <FileInput onFileLoaded={onFileLoaded} />\n\n      <div className=\"App__container\">\n        <div className=\"App__column\">\n          <p>Hover Color:</p>\n          <ColorPreview backgroundColor={hoverColor} />\n\n          <p>Selected Color:</p>\n          <ColorPreview backgroundColor={selectedColor} />\n        </div>\n        <div className=\"App__column\">\n          <p>X pixel position:</p> {xPos}\n          <p>Y pixel position:</p> {yPos}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}